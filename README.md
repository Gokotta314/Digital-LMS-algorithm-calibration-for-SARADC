# Digital-LMS-algorithm-calibration-for-SARADC
Successive approximation register SAR ADCs are commonly adopted because of their simple structure and low power consumption. However, it is quite difficult to design a high-speed SAR ADC with a resolution of more than 10 bits due to unavoidable capacitor mismatch problem in capacitive DACs. In order to address the capacitor mismatch problem, this work designed a 12-bit 25 Ms/s SAR ADC in 40 nm CMOS. VCM-based CDAC and Rotating\&averaging technique are employed to calibrate capacitor mismatch, without increasing the area of capacitors, by simply using different combinations of capacitor groups for four conversions of the same input signal and averaging the results. Simulation of random mismatch with a standard deviation of 1\% demonstrates that the error can be reduced from $2.5×10^{-3}$ mV(\~10 LSB) to $1×10^{-3}$ mV(\~4 LSB), and the INL is improved from 5 LSB to 1.5 LSB. LMS algorithm is utilised to perform the digital calibration, whereby the mismatch error is computed based on the average of the results of the four conversions to extract the real bit-weights. Simulation indicates that calibration convergence is achieved within 20,000 samples, which can further reduce the error to $5×10^{-4}$ mV(~2 LSB), and the INL is shown to improve to 0.5 LSB. Moreover, it is possible to terminate rotation\&averaging process once the calibration has been completed, thus enhancing sampling rate up to 80 Ms/s, which effectively solves the issue of low conversion rate that is typically caused by the rotation and averaging technique.
逐次逼近寄存器SAR ADC结构简单、功耗低，因此被普遍采用。然而，由于电容DAC中不可避免的电容失配问题，要设计出分辨率超过10位的高速SAR ADC相当困难。本文使用40 nm COMS工艺设计了一款12位25 Ms/s SAR ADC。针对电容失配问题，采用VCM-based CDAC，利用旋转平均技术对电容失配进行校正，在不增加电容面积的情况下，采用不同电容组合对同一输入信号进行四次转换并求平均值。对标准差为1\%的随机失配仿真，结果显示可以将误差由范围从$2.5×10^{-3}$ mV（约10 LSB）降至从$1×10^{-3}$ mV（约4 LSB），INL由5 LSB改善为1.5 LSB。配合LMS算法进行数字校准，基于四次转换结果的平均值计算误差，求解真实的电容权重，仿真显示LMS算法在20000次转换内完成收敛，可以进一步将误差降低至$5×10^{-4}$ mV（约2 LSB），INL改善为0.5 LSB。并且，在完成校准后可停止旋转平均操作，从而使采样率达到80 Ms/s，解决了旋转平均技术导致转换率低的问题。
